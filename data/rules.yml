version: "2.0"
rules:
- rule: user sends /start command in Telegram, greets the bot or asks how the bot works
  steps:
  - or:
    - intent: start
    - intent: greet
    - intent: how_it_works
  - action: action_offer_chitchat
- rule: the bot offers chitchat and the user agrees
  steps:
  - action: action_offer_chitchat
  - intent: affirm
  - action: action_find_partner
- rule: someone asks the user to join/confirm a video chat
  steps:
  - or:
    - intent: EXTERNAL_ask_to_join
    - intent: EXTERNAL_ask_to_confirm
    - intent: EXTERNAL_ask_to_confirm_drop_in
  - action: action_ask_to_join
- rule: the user aggrees to join the call
  steps:
  - action: action_ask_to_join
  - or:
    - intent: affirm
    - intent: want_chitchat
  - action: action_accept_invitation
- rule: the user refuses to join the call
  steps:
  - action: action_ask_to_join
  - intent: deny
  - action: action_reject_invitation
- rule: ask next random partner
  steps:
  - intent: EXTERNAL_find_partner
  - action: action_find_partner
- rule: a partner confirms readiness for the video chat and the user receives the room url
  steps:
  - intent: EXTERNAL_join_room
  - action: action_join_room
- rule: user asks the bot if the bot is a bot
  steps:
  - intent: bot_challenge
  - action: utter_iamabot
- rule: user asks not to bother them
  steps:
  - intent: dont_bother_me
  - action: action_do_not_disturb
- rule: user asks for chitchat directly
  steps:
  - intent: want_chitchat
  - action: action_find_partner
- rule: it took too long for partner to confirm - we need to let the user know that pertner is likely not available
  steps:
  - intent: EXTERNAL_expire_partner_confirmation
  - action: action_expire_partner_confirmation
