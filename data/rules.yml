version: "2.0"
rules:
- rule: user sends /start command in Telegram or just greets the bot
  steps:
  - or:
    - intent: start
    - intent: greet
  - action: utter_greet_offer_chitchat
- rule: user asks how the bot works
  steps:
  - intent: how_it_works
  - action: utter_how_it_works
- rule: user says that they are sad
  steps:
  - intent: mood_unhappy
  - action: utter_sad_offer_chitchat
- rule: user asks for something that is out of scope
  steps:
  - intent: out_of_scope
  - action: utter_out_of_scope_offer_chitchat
- rule: the bot greets the user, offers chitchat and the user agrees
  steps:
  - action: utter_greet_offer_chitchat
  - intent: affirm
  - action: utter_ok_arranging_chitchat
  - action: action_find_partner
- rule: the bot explains how it works and the user agrees
  steps:
  - action: utter_how_it_works
  - intent: affirm
  - action: utter_ok_arranging_chitchat
  - action: action_find_partner
- rule: the bot responds to a sad user, offers chitchat and the user agrees
  steps:
  - action: utter_sad_offer_chitchat
  - intent: affirm
  - action: utter_ok_arranging_chitchat
  - action: action_find_partner
- rule: the bot responds to an out-of-scope intent, offers chitchat instead and the user agrees
  steps:
  - action: utter_out_of_scope_offer_chitchat
  - intent: affirm
  - action: utter_ok_arranging_chitchat
  - action: action_find_partner
- rule: user asks for chitchat directly
  steps:
  - intent: want_chitchat
  - action: utter_ok_arranging_chitchat
  - action: action_find_partner
- rule: the bot greets the user, offers chitchat but the user denies
  steps:
  - action: utter_greet_offer_chitchat
  - intent: deny
  - action: utter_mind_helping_lonely_person
- rule: the bot explains how it works but the user denies
  steps:
  - action: utter_how_it_works
  - intent: deny
  - action: utter_mind_helping_lonely_person
- rule: the bot responds to a sad user, offers chitchat but the user denies
  steps:
  - action: utter_sad_offer_chitchat
  - intent: deny
  - action: utter_mind_helping_lonely_person
- rule: the bot responds to an out-of-scope intent, offers chitchat instead but the user denies
  steps:
  - action: utter_out_of_scope_offer_chitchat
  - intent: deny
  - action: utter_mind_helping_lonely_person
- rule: the bot asks the user to stick around for the sake of other people and the user says they WOULD NOT mind
  steps:
  - action: utter_mind_helping_lonely_person
  - intent: deny
  - action: action_become_ok_to_chitchat
- rule: the bot asks the user to stick around for the sake of other people but the user says they WOULD mind
  steps:
  - action: utter_mind_helping_lonely_person
  - intent: affirm
  - action: action_do_not_disturb
  - action: utter_hope_to_see_you_later
- rule: someone else asks the user to join a video chat
  steps:
  - intent: EXTERNAL_ask_to_join
  - action: action_ask_to_join
- rule: someone else wants to chat and the user aggrees to join
  steps:
  - action: action_ask_to_join
  - or:
    - intent: affirm
    - intent: want_chitchat
  - action: action_create_room
- rule: someone else wants to chat but the user refuses to join
  steps:
  - action: action_ask_to_join
  - intent: deny
  - action: action_do_not_disturb
  - action: utter_let_them_go_stop_bothering
- rule: the bot offers to find a replacement for a partner that wasn't waiting anymore and the user agrees
  condition:
  - slot_was_set:
    - swiper_action_result: partner_not_waiting_anymore
  steps:
  - action: action_create_room
  - or:
    - intent: affirm
    - intent: want_chitchat
  - action: utter_ok_arranging_chitchat
  - action: action_find_partner
- rule: the bot offers to find a replacement for a partner that wasn't waiting anymore but the user denies
  condition:
  - slot_was_set:
    - swiper_action_result: partner_not_waiting_anymore
  steps:
  - action: action_create_room
  - intent: deny
  - action: utter_bye_till_next_time
- rule: a partner rejected chitchat - we need to find someone else for the user
  steps:
  - intent: EXTERNAL_find_partner
  - action: action_find_partner
- rule: the bot lets a partner go, asks if the user doesn't want to be bothered and the user confirms
  steps:
  - action: utter_let_them_go_stop_bothering
  - intent: affirm
  - action: utter_hope_to_see_you_later
- rule: the bot lets a partner go, asks if the user doesn't want to be bothered but the user denies
  steps:
  - action: utter_let_them_go_stop_bothering
  - intent: deny
  - action: action_become_ok_to_chitchat
- rule: a partner agrees to join a video chat and the user receives the room url
  steps:
  - intent: EXTERNAL_join_room
  - action: action_join_room
- rule: user asks not to bother them
  steps:
  - intent: dont_bother_me
  - action: action_do_not_disturb
  - action: utter_hope_to_see_you_later
- rule: user asks the bot if the bot is a bot
  steps:
  - intent: bot_challenge
  - action: utter_iamabot
